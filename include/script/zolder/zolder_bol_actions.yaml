zolder_bol_actions:
  alias: "Zolder - Acties voor Zolder Bol Template"
  icon: mdi:lamp
  sequence:
    - alias: "Welke actie"
      choose:
      - conditions:
          - alias: "Aan"
            condition: template
            value_template: "{{ action == 'on' }}"
        sequence:
          - alias: "Zolder Bol aan"
            choose:
            - conditions:
                - alias: "Bureau Marleen uit"
                  condition: state
                  entity_id: switch.bureau_marleen
                  state: "off"
              sequence:
                - alias: "Bureau Marleen aanzetten"
                  service: switch.turn_on
                  target:
                    entity_id: switch.bureau_marleen
                - wait_for_trigger:
                    - platform: state
                      entity_id: light.zolder_bol
                      from: "unavailable"
                  timeout:
                    seconds: 10
                - alias: "Lamp aanzetten"
                  service: light.turn_on
                  target:
                    entity_id: light.zolder_bol
            default:
              - alias: "Lamp aanzetten"
                service: light.turn_on
                target:
                  entity_id: light.zolder_bol
      - conditions:
          - alias: "Aan"
            condition: template
            value_template: "{{ action == 'off' }}"
        sequence:
          - alias: "Zolder Bol uit"
            choose:
            - conditions:
                - alias: "Computer Marleen uit"
                  condition: state
                  entity_id: binary_sensor.imac_marleen
                  state: "off"
                - condition: not
                  conditions:
                    - alias: "Printer actief"
                      condition: state
                      entity_id: sensor.dcp_l2530dw_status
                      state: "printing"
                - alias: "Weinig verbruik"
                  condition: numeric_state
                  entity_id: sensor.bureau_marleen_power
                  below: 20
              sequence:
                - alias: "Lamp uitzetten"
                  service: light.turn_off
                  target:
                    entity_id: light.zolder_bol
                - delay: 30
                - alias: "Bureau Marleen uitzetten"
                  service: switch.turn_off
                  target:
                    entity_id: switch.bureau_marleen
            default:
              - alias: "Lamp uitzetten"
                service: light.turn_off
                target:
                  entity_id: light.zolder_bol
