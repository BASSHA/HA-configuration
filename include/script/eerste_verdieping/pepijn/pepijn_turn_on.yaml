pepijn_turn_on:
  alias: "Eerste Verdieping | Pepijn - Acties bij lamp aan"
  icon: mdi:ceiling-light
  sequence:
    - alias: "Geen transitie actief en nog niet gedimd aangeweest?"
      choose:
        - alias: "Geen transitie actief en nog niet gedimd geweest "
          conditions: 
            - alias: "Geen transition actief?"
              condition: state
              entity_id: input_boolean.transition_pepijn_active
              state: "off"
            - alias: "Nog niet gedimd?"
              condition: state
              entity_id: input_boolean.dimmed_pepijn
              state: "off"
          sequence:
            - alias: "Input boolean aanzetten"
              service: input_boolean.turn_on
              target:
                entity_id: input_boolean.dimmed_pepijn
            - alias: "Avond, overdag of ochtend?"
              choose:
                - alias: "Ochtend"
                  conditions:
                    - condition: time
                      after: input_datetime.pepijn_transition_on
                      before: input_datetime.pepijn_transition_off
                  sequence:
                    - alias: "Lamp langzaam aan"
                      service: script.transition_lampen
                      data:
                        id: pepijn
                        change_start: true
                        bright_start: 39
                        color_start: "{{ state_attr('light.pepijn', 'max_mireds') }}"
                        bright_goal: 255
                        color_goal: "{{ state_attr('light.pepijn', 'min_mireds') }}"
                        bright_step: 2
                        step_time: 0.5
                        dim: false
                - alias: "Avond en nacht"
                  conditions:
                    - condition: or
                      conditions:
                        - condition: time
                          after: input_datetime.pepijn_dim_on
                        - condition: time
                          before: input_datetime.pepijn_dim_off
                  sequence:
                    - alias: "Lamp gedimd aan"
                      service: light.turn_on
                      data:
                        entity_id: light.pepijn
                        brightness: 40
                        color_temp: "{{ state_attr('light.pepijn', 'max_mireds') }}"
              default:
                - alias: "Plafondlamp aan op 100%"
                  service: light.turn_on
                  target:
                    entity_id: light.pepijn
                  data:
                    brightness: 255
                - alias: "Bedtijd?"
                  condition: time
                  after: "18:00:00"
                  before: "20:00:00"
                - alias: "Nijntje aan"
                  service: light.turn_on
                  target:
                    entity_id: light.nijntje
      default:
        - alias: "Lamp aan op huidige helderheid/kleur"
          service: light.turn_on
          target:
            entity_id: light.pepijn
        - alias: "Bedtijd?"
          condition: time
          after: "18:00:00"
          before: "20:00:00"
        - alias: "Nijntje aan"
          service: light.turn_on
          target:
            entity_id: light.nijntje

