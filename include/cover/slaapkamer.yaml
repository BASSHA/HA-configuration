platform: template
covers:
  slaapkamer:
    availability_template: >
      {{ 
        (not is_state('cover.slaapkamer_links', 'unavailable')) 
        and (not is_state('cover.slaapkamer_midden', 'unavailable')) 
        and (not is_state('cover.slaapkamer_rechts', 'unavailable')) 
      }}
    device_class: blind
    friendly_name: "Screens Slaapkamer"
    position_template: >
      {% if is_state('input_boolean.cover_slaapkamer_temp_fix', 'on') %}
        {{ 0 if is_state('cover.slaapkamer_groep', 'closed') else 100 }}
      {% elif is_state('input_boolean.cover_slaapkamer_invert', 'on') %}
        {{ 100 - state_attr('cover.slaapkamer_groep', 'current_position') | float(100) }}
      {% else %}
        {{ state_attr('cover.slaapkamer_groep', 'current_position') | float(0) }}
      {% endif %}
    open_cover:
      service: cover.set_cover_position
      #        {% if is_state('input_boolean.cover_slaapkamer_invert', 'on') %}
      #          cover.close_cover
      #        {% else %}
      #          cover.open_cover
      #        {% endif %}
      entity_id: cover.slaapkamer_groep
      data:
        position: >
          {% 
            if is_state('input_boolean.cover_slaapkamer_invert', 'on') 
            or is_state('input_boolean.cover_slaapkamer_temp_fix', 'on')
          %}
            0
          {% else %}
            100
          {% endif %}
    close_cover:
      service: cover.set_cover_position
      #        {% if is_state('input_boolean.cover_slaapkamer_invert', 'on') %}
      #          cover.open_cover
      #        {% else %}
      #          cover.close_cover
      #        {% endif %}
      entity_id: cover.slaapkamer_groep
      data:
        position: >
          {% 
            if is_state('input_boolean.cover_slaapkamer_invert', 'on') 
            or is_state('input_boolean.cover_slaapkamer_temp_fix', 'on')
          %}
            100
          {% else %}
            0
          {% endif %}
    stop_cover:
      service: cover.stop_cover
      entity_id: cover.slaapkamer_groep
    set_cover_position:
      service: cover.set_cover_position
      entity_id: cover.slaapkamer_groep
      data:
        position: >
          {% 
            if is_state('input_boolean.cover_slaapkamer_invert', 'on') 
            or is_state('input_boolean.cover_slaapkamer_temp_fix', 'on')
          %}
            {{ 100 - position }}
          {% else %}
            {{ position }}
          {% endif %}
